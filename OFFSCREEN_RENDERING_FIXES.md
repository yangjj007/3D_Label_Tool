# ç¦»å±æ¸²æŸ“ä¿®å¤è¯´æ˜

## ğŸ”§ å·²ä¿®å¤çš„é—®é¢˜

### é—®é¢˜1ï¼šæ¨¡å‹ç²—ç³™
**åŸå› **: 
- æ¸²æŸ“åˆ†è¾¨ç‡å¤ªä½ï¼ˆ800x600ï¼‰
- å…³é—­äº†æŠ—é”¯é½¿

**ä¿®å¤**:
- âœ… æé«˜æ¸²æŸ“åˆ†è¾¨ç‡ï¼š800x600 â†’ 1200x900
- âœ… å¯ç”¨æŠ—é”¯é½¿ï¼š`antialias: true`
- âœ… ä¿æŒé«˜è´¨é‡è®¾ç½®

### é—®é¢˜2ï¼šæ²¡æœ‰é»„è‰²è¾¹æ¡†é«˜äº®
**åŸå› **: 
- ç¼ºå°‘ `OutlinePass` åæœŸå¤„ç†
- æ²¡æœ‰è®¾ç½®é€‰ä¸­æè´¨

**ä¿®å¤**:
- âœ… æ·»åŠ  `EffectComposer` åæœŸå¤„ç†ç®¡çº¿
- âœ… æ·»åŠ  `OutlinePass` ç”¨äºæè´¨é«˜äº®
- âœ… é…ç½®é»„è‰²è¾¹æ¡†ï¼ˆ#FFFF00ï¼‰
- âœ… åœ¨æˆªå›¾æ—¶è‡ªåŠ¨é«˜äº®å½“å‰æè´¨

## ğŸ“Š æ ¸å¿ƒæ”¹åŠ¨

### 1. å¯¼å…¥åæœŸå¤„ç†æ¨¡å—
```javascript
import { EffectComposer } from "three/addons/postprocessing/EffectComposer.js";
import { RenderPass } from "three/addons/postprocessing/RenderPass.js";
import { OutlinePass } from "three/addons/postprocessing/OutlinePass.js";
import { OutputPass } from "three/addons/postprocessing/OutputPass.js";
```

### 2. æ·»åŠ åæœŸå¤„ç†ç»„ä»¶
```javascript
// åœ¨æ„é€ å‡½æ•°ä¸­
this.effectComposer = null;
this.outlinePass = null;

// åœ¨ init() ä¸­
this.setupPostProcessing();
```

### 3. OutlinePass é…ç½®
å‚è€ƒä¸»åº”ç”¨çš„é…ç½®ï¼š
```javascript
this.outlinePass.visibleEdgeColor = new THREE.Color('#FFFF00'); // é»„è‰²
this.outlinePass.hiddenEdgeColor = new THREE.Color('#FFFF00'); // é»„è‰²
this.outlinePass.edgeGlow = 2.0; // å‘å…‰å¼ºåº¦
this.outlinePass.edgeThickness = 2.0; // è¾¹ç¼˜ç²—ç»†
this.outlinePass.edgeStrength = 5.0; // è¾¹ç¼˜å¼ºåº¦
this.outlinePass.pulsePeriod = 0; // ä¸é—ªçƒ
```

### 4. æˆªå›¾æ—¶é«˜äº®æè´¨
```javascript
// åœ¨ captureMultiAngleMaterial ä¸­
this.outlinePass.selectedObjects = [mesh]; // è®¾ç½®é«˜äº®
// ... æˆªå›¾ ...
this.outlinePass.selectedObjects = []; // æ¸…é™¤é«˜äº®
```

### 5. ä½¿ç”¨ EffectComposer æ¸²æŸ“
```javascript
// åœ¨ render() ä¸­
if (this.effectComposer) {
  this.effectComposer.render(); // åŒ…å« OutlinePass
} else {
  this.renderer.render(this.scene, this.camera);
}
```

## ğŸ¨ æ¸²æŸ“è´¨é‡æå‡

### åˆ†è¾¨ç‡
- **ä¹‹å‰**: 800 x 600 = 480,000 åƒç´ 
- **ç°åœ¨**: 1200 x 900 = 1,080,000 åƒç´ 
- **æå‡**: 2.25 å€

### æŠ—é”¯é½¿
- **ä¹‹å‰**: å…³é—­ï¼ˆantialias: falseï¼‰
- **ç°åœ¨**: å¯ç”¨ï¼ˆantialias: trueï¼‰
- **æ•ˆæœ**: è¾¹ç¼˜æ›´å¹³æ»‘

### åæœŸå¤„ç†
- **ä¹‹å‰**: æ— 
- **ç°åœ¨**: EffectComposer + OutlinePass
- **æ•ˆæœ**: é»„è‰²è¾¹æ¡†é«˜äº®

## ğŸ” é¢„æœŸæ•ˆæœ

### æˆªå›¾è´¨é‡
- âœ… æ¨¡å‹æ›´æ¸…æ™°ï¼ˆé«˜åˆ†è¾¨ç‡ï¼‰
- âœ… è¾¹ç¼˜æ›´å¹³æ»‘ï¼ˆæŠ—é”¯é½¿ï¼‰
- âœ… æè´¨æœ‰é»„è‰²è¾¹æ¡†ï¼ˆOutlinePassï¼‰
- âœ… æ•´ä½“æ›´ç»†è…»

### VLM è¯†åˆ«
VLM ç°åœ¨åº”è¯¥èƒ½çœ‹åˆ°ï¼š
1. âœ… æ¸…æ™°çš„ 3D æ¨¡å‹
2. âœ… **é»„è‰²è¾¹æ¡†**å›´ç»•é€‰ä¸­çš„æè´¨
3. âœ… é«˜è´¨é‡çš„æ¸²æŸ“æ•ˆæœ

## ğŸ“ è°ƒè¯•ä¿¡æ¯

æ§åˆ¶å°ä¼šè¾“å‡ºï¼š
```
[OffscreenRenderModel] è®¾ç½®åæœŸå¤„ç†...
[OffscreenRenderModel] åæœŸå¤„ç†è®¾ç½®å®Œæˆ
[OffscreenRenderModel] å·²è®¾ç½® OutlinePass é«˜äº®: [æè´¨å]
[OffscreenRenderModel] å·²æ¸…é™¤ OutlinePass é€‰æ‹©
```

## ğŸš€ ä½¿ç”¨è¯´æ˜

### 1. åˆ·æ–°é¡µé¢
ç¡®ä¿åŠ è½½æœ€æ–°ä»£ç ï¼š
```
Ctrl + F5 (Windows)
Cmd + Shift + R (Mac)
```

### 2. å¼€å§‹æ‰¹é‡æ‰“æ ‡
- æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
- å¼€å§‹æ‰¹é‡æ‰“æ ‡
- è§‚å¯Ÿæ—¥å¿—è¾“å‡º

### 3. æ£€æŸ¥æˆªå›¾
ä¸‹è½½çš„æˆªå›¾åº”è¯¥æ˜¾ç¤ºï¼š
- âœ… é«˜æ¸…çš„ 3D æ¨¡å‹
- âœ… **é»„è‰²è¾¹æ¡†**å›´ç»•æè´¨
- âœ… å¹³æ»‘çš„è¾¹ç¼˜

### 4. VLM è¯†åˆ«
VLM æç¤ºè¯åº”è¯¥èƒ½è¯†åˆ«ï¼š
```
"Please identify the yellow-bordered region in this 3D model view..."
```

## ğŸ” å¯¹æ¯”

### ä¹‹å‰çš„æˆªå›¾
- âŒ æ¨¡å‹ç²—ç³™ã€åƒç´ åŒ–
- âŒ æ²¡æœ‰é»„è‰²è¾¹æ¡†
- âŒ è¾¹ç¼˜é”¯é½¿æ˜æ˜¾

### ç°åœ¨çš„æˆªå›¾ï¼ˆé¢„æœŸï¼‰
- âœ… æ¨¡å‹æ¸…æ™°ã€ç»†è…»
- âœ… é»„è‰²è¾¹æ¡†æ¸…æ™°å¯è§
- âœ… è¾¹ç¼˜å¹³æ»‘

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ€§èƒ½å½±å“
- é«˜åˆ†è¾¨ç‡ + æŠ—é”¯é½¿ + åæœŸå¤„ç† = **æ›´å¤šGPUèµ„æº**
- å»ºè®®åœ¨é«˜æ€§èƒ½è®¾å¤‡ä¸Šè¿è¡Œ
- å¦‚æœå¡é¡¿ï¼Œå¯ä»¥è°ƒä½åˆ†è¾¨ç‡ï¼ˆä¿®æ”¹æ„é€ å‡½æ•°å‚æ•°ï¼‰

### å†…å­˜å ç”¨
- å•ä¸ªæ¸²æŸ“å™¨å†…å­˜å ç”¨å¢åŠ ï¼ˆçº¦ 150MB â†’ 250MBï¼‰
- 10ä¸ªå¹¶å‘çº¦éœ€ 2.5GB å†…å­˜
- å»ºè®®ç³»ç»Ÿå†…å­˜ â‰¥ 16GB

### è°ƒæ•´åˆ†è¾¨ç‡ï¼ˆå¯é€‰ï¼‰
å¦‚æœéœ€è¦è°ƒæ•´ï¼Œä¿®æ”¹æ„é€ å‡½æ•°ï¼š
```javascript
// åœ¨ src/utils/OffscreenRenderModel.js
constructor(width = 1200, height = 900) {
  // å¯ä»¥æ”¹ä¸º 800x600ï¼ˆä½è´¨é‡ï¼‰æˆ– 1600x1200ï¼ˆè¶…é«˜è´¨é‡ï¼‰
}
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| é…ç½® | åˆ†è¾¨ç‡ | æŠ—é”¯é½¿ | åæœŸå¤„ç† | å•å¼ è€—æ—¶ | è´¨é‡ |
|------|--------|--------|----------|----------|------|
| ä¹‹å‰ | 800x600 | âŒ | âŒ | ~100ms | â­â­ |
| ç°åœ¨ | 1200x900 | âœ… | âœ… | ~200ms | â­â­â­â­â­ |

## ğŸ¯ éªŒè¯æ¸…å•

æµ‹è¯•æ—¶è¯·æ£€æŸ¥ï¼š

- [ ] åˆ·æ–°é¡µé¢åŠ è½½æ–°ä»£ç 
- [ ] æ§åˆ¶å°æ˜¾ç¤º"åæœŸå¤„ç†è®¾ç½®å®Œæˆ"
- [ ] æ§åˆ¶å°æ˜¾ç¤º"å·²è®¾ç½® OutlinePass é«˜äº®"
- [ ] ä¸‹è½½çš„æˆªå›¾æ˜¾ç¤ºé»„è‰²è¾¹æ¡†
- [ ] æˆªå›¾è´¨é‡æ˜æ˜¾æå‡
- [ ] VLM èƒ½è¯†åˆ«é»„è‰²è¾¹æ¡†åŒºåŸŸ

## ğŸ› æ•…éšœæ’é™¤

### å¦‚æœè¿˜æ˜¯æ²¡æœ‰é»„è‰²è¾¹æ¡†
**æ£€æŸ¥æ—¥å¿—**ï¼š
```
[OffscreenRenderModel] OutlinePass æœªåˆå§‹åŒ–  â† é—®é¢˜
```
**è§£å†³**ï¼šåˆ·æ–°é¡µé¢é‡è¯•

### å¦‚æœæˆªå›¾è¿˜æ˜¯ç²—ç³™
**æ£€æŸ¥æ—¥å¿—**ï¼š
æŸ¥çœ‹åˆå§‹åŒ–åˆ†è¾¨ç‡æ˜¯å¦æ­£ç¡®
**è§£å†³**ï¼šç¡®è®¤ä»£ç å·²æ›´æ–°

### å¦‚æœæ€§èƒ½å¾ˆæ…¢
**è§£å†³**ï¼š
1. é™ä½å¹¶å‘åº¦ï¼ˆ10 â†’ 5ï¼‰
2. é™ä½åˆ†è¾¨ç‡ï¼ˆ1200x900 â†’ 800x600ï¼‰

## ğŸ“š ç›¸å…³æ–‡ä»¶

ä¿®æ”¹çš„æ–‡ä»¶ï¼š
- âœ… `src/utils/OffscreenRenderModel.js` - ä¸»è¦ä¿®æ”¹

åˆ›å»ºçš„æ–‡æ¡£ï¼š
- ğŸ“„ `OFFSCREEN_DEBUG_GUIDE.md` - è°ƒè¯•æŒ‡å—
- ğŸ“„ `OFFSCREEN_RENDERING_FIXES.md` - æœ¬æ–‡æ¡£

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2025-01-13
**çŠ¶æ€**: âœ… å·²ä¿®å¤
**æµ‹è¯•**: å¾…éªŒè¯

**è¯·åˆ·æ–°é¡µé¢å¹¶é‡æ–°æµ‹è¯•ï¼** ğŸš€

