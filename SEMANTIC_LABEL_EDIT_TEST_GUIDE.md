# 语义标签编辑功能测试指南

## 快速测试步骤

### 准备工作

1. **启动开发服务器**
   ```bash
   pnpm run dev:full
   # 或
   yarn serve
   ```

2. **准备测试数据**
   - 确保有包含语义标签的 GLB/GLTF 模型文件
   - 或者先使用批量打标功能为模型添加语义标签

### 测试场景 1: 基本编辑功能

**步骤：**

1. 在左侧文件列表中选择一个已打标的模型
2. 等待模型加载完成
3. 在3D视图中点击模型的任一材质对象
4. 观察右上角是否显示"语义标签"面板
5. 点击面板右上角的编辑图标（铅笔形状）
6. 在弹出的对话框中修改标签内容
7. 点击"保存并写入模型"按钮
8. 等待保存完成的提示

**预期结果：**
- ✅ 语义标签面板正确显示
- ✅ 编辑图标可见且可点击
- ✅ 编辑弹窗正确显示当前标签内容
- ✅ 保存后显示成功提示
- ✅ 再次点击同一材质，显示更新后的标签

### 测试场景 2: 空标签处理

**步骤：**

1. 选择一个没有语义标签的材质对象
2. 观察语义标签面板是否显示

**预期结果：**
- ✅ 不显示语义标签面板
- ✅ 不会出现错误提示

### 测试场景 3: 长文本处理

**步骤：**

1. 打开编辑弹窗
2. 输入超过2000字符的内容
3. 尝试保存

**预期结果：**
- ✅ 输入框限制最多2000字符
- ✅ 显示字数统计
- ✅ 超过限制时无法继续输入

### 测试场景 4: 取消编辑

**步骤：**

1. 打开编辑弹窗
2. 修改标签内容
3. 点击"取消"按钮
4. 再次打开编辑弹窗

**预期结果：**
- ✅ 弹窗关闭
- ✅ 标签内容未被修改
- ✅ 再次打开时显示原始内容

### 测试场景 5: 文件持久化

**步骤：**

1. 编辑并保存一个语义标签
2. 刷新浏览器页面
3. 重新选择相同的文件
4. 点击相同的材质对象

**预期结果：**
- ✅ 刷新后标签修改仍然保留
- ✅ 从 IndexedDB 读取到更新后的标签

### 测试场景 6: 服务器同步（如果启用）

**步骤：**

1. 从服务器加载一个文件
2. 编辑其语义标签并保存
3. 检查服务器的 `labeled_files` 文件夹

**预期结果：**
- ✅ 本地保存成功
- ✅ 服务器文件夹中出现更新后的文件
- ✅ 如果服务器同步失败，本地仍然保存成功

### 测试场景 7: 不支持的格式

**步骤：**

1. 加载一个 OBJ 或其他非 GLB/GLTF 格式的模型
2. 如果有语义标签，尝试编辑
3. 点击保存

**预期结果：**
- ✅ 显示格式不支持的提示
- ✅ 不执行保存操作

## 浏览器控制台检查

打开浏览器开发者工具（F12），观察控制台输出：

### 正常流程的日志

```
[编辑语义标签] 打开编辑弹窗: {meshName: "...", hasLabel: true, fileName: "..."}
[语义标签编辑] 已更新 mesh.userData.semanticLabel: ...
[语义标签编辑] 开始导出模型...
[语义标签编辑] 共有 N 个对象包含语义标签
[语义标签编辑] 成功写入 N 个标签到 GLB
[语义标签编辑] 已保存到 IndexedDB: ...
[语义标签编辑] 文件保存完成: ...
[编辑语义标签] 保存成功: {meshName: "...", newLabel: "..."}
```

### 错误检查

如果出现错误，查看控制台中的错误信息：
- 红色错误信息表示严重问题
- 橙色警告信息表示非关键问题

## 测试检查清单

- [ ] 语义标签面板显示正常
- [ ] 编辑图标样式正确（悬停时高亮）
- [ ] 编辑弹窗能够正确打开和关闭
- [ ] 标签内容能够正确显示和编辑
- [ ] 保存功能正常工作
- [ ] 本地存储（IndexedDB）更新成功
- [ ] 服务器同步正常（如果适用）
- [ ] 刷新后数据持久化
- [ ] 字数限制和统计正常
- [ ] 取消操作不修改数据
- [ ] 错误提示清晰明确
- [ ] 界面响应流畅，无卡顿

## 已知限制

1. **文件格式**: 目前仅支持 GLB/GLTF 格式
2. **大文件**: 大型模型（>50MB）保存可能较慢
3. **并发编辑**: 不支持多用户同时编辑同一文件
4. **历史记录**: 暂不支持撤销/重做

## 报告问题

如果发现问题，请记录以下信息：

1. **复现步骤**: 详细的操作步骤
2. **预期行为**: 应该发生什么
3. **实际行为**: 实际发生了什么
4. **错误信息**: 浏览器控制台的错误日志
5. **环境信息**: 
   - 浏览器版本
   - 操作系统
   - 模型文件大小和格式
   - 网络环境（本地/服务器）

## 性能测试

### 建议测试的模型大小

- 小文件: < 1MB
- 中等文件: 1-10MB
- 大文件: 10-50MB
- 超大文件: > 50MB（可选）

### 性能指标

测量以下操作的耗时：
- 打开编辑弹窗: 应 < 100ms
- 保存小文件: 应 < 2秒
- 保存中等文件: 应 < 5秒
- 保存大文件: 应 < 15秒

## 反馈渠道

测试完成后，请反馈：
- ✅ 功能正常工作的场景
- ❌ 发现问题的场景
- 💡 改进建议

---

**祝测试顺利！** 🎉

